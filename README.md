<h1 align="center">Há»† THá»NG PHÃT HIá»†N CHUYá»‚N Äá»˜NG VÃ€ NHáº¬N DIá»†N KHUÃ”N Máº¶T TRONG GIÃM SÃT AN NINH </h1>

<div align="center">

<p align="center">
  <img src="images/Logo_DAI_NAM.png" alt="DaiNam University Logo" width="200"/>
  <img src="images/logoiaot.png" alt="AIoTLab Logo" width="170"/>
</p>

[![Made by AIoTLab](https://img.shields.io/badge/Made%20by%20AIoTLab-blue?style=for-the-badge)](https://www.facebook.com/DNUAIoTLab)
[![Fit DNU](https://img.shields.io/badge/Fit%20DNU-green?style=for-the-badge)](https://fitdnu.net/)
[![DaiNam University](https://img.shields.io/badge/DaiNam%20University-red?style=for-the-badge)](https://dainam.edu.vn)

</div>
<h2 align="center">Há»‡ Thá»‘ng PhÃ¡t Hiá»‡n Chuyá»ƒn Äá»™ng vÃ  Nháº­n Diá»‡n KhuÃ´n Máº·t</h2>

**PhÃ¡t triá»ƒn bá»Ÿi NhÃ³m 4 Lá»›p CNTT 1601, Khoa CÃ´ng nghá»‡ ThÃ´ng tin, Äáº¡i há»c Äáº¡i Nam**

## ğŸ”¬ TÄƒng cÆ°á»ng An ninh vá»›i CÃ´ng nghá»‡ GiÃ¡m sÃ¡t ThÃ´ng minh

Há»‡ thá»‘ng tháº¿ há»‡ má»›i tÃ­ch há»£p phÃ¡t hiá»‡n chuyá»ƒn Ä‘á»™ng vÃ  nháº­n diá»‡n danh tÃ­nh, sá»­ dá»¥ng OpenCV, YOLOv8 vÃ  DeepFace, há»— trá»£ cáº£nh bÃ¡o thá»i gian thá»±c qua Telegram.

## ğŸ—ï¸ Kiáº¿n trÃºc Há»‡ thá»‘ng

### Tá»•ng quan

Há»‡ thá»‘ng hoáº¡t Ä‘á»™ng dá»±a trÃªn kiáº¿n trÃºc Ä‘a luá»“ng, bao gá»“m cÃ¡c thÃ nh pháº§n chÃ­nh:

- ğŸ“· **Xá»­ lÃ½ Video**: Thu tháº­p video tá»« camera, phÃ¡t hiá»‡n chuyá»ƒn Ä‘á»™ng báº±ng phÆ°Æ¡ng phÃ¡p trá»« ná»n vÃ  nháº­n diá»‡n ngÆ°á»i vá»›i YOLOv8.
- ğŸ‘¤ **Nháº­n diá»‡n Danh tÃ­nh**: PhÃ¡t hiá»‡n khuÃ´n máº·t báº±ng OpenCV Haar Cascade vÃ  táº¡o embedding vá»›i DeepFace Ä‘á»ƒ nháº­n diá»‡n.
- ğŸš¨ **Cáº£nh bÃ¡o**: Gá»­i thÃ´ng bÃ¡o, áº£nh vÃ  video qua Telegram, xá»­ lÃ½ tÃ¡c vá»¥ báº¥t Ä‘á»“ng bá»™ Ä‘á»ƒ Ä‘áº£m báº£o hiá»‡u suáº¥t.

## âœ¨ TÃ­nh nÄƒng Ná»•i báº­t

### ğŸ§  PhÃ¡t hiá»‡n ThÃ´ng minh

- **PhÃ¡t hiá»‡n Chuyá»ƒn Ä‘á»™ng**: Theo dÃµi chuyá»ƒn Ä‘á»™ng thá»i gian thá»±c báº±ng cÃ¡ch so sÃ¡nh khung hÃ¬nh.
- **PhÃ¡t hiá»‡n NgÆ°á»i**: Sá»­ dá»¥ng YOLOv8 Ä‘á»ƒ nháº­n diá»‡n chÃ­nh xÃ¡c ngÆ°á»i trong video.
- **Nháº­n diá»‡n KhuÃ´n máº·t**: Ãp dá»¥ng DeepFace (Facenet512) Ä‘á»ƒ khá»›p khuÃ´n máº·t vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u.

### âš¡ Cáº£nh bÃ¡o Thá»i gian thá»±c

- **TÃ­ch há»£p Telegram**: Gá»­i áº£nh, video vÃ  cáº£nh bÃ¡o tá»©c thÃ¬ qua Telegram.
- **Lá»‡nh TÃ¹y chá»‰nh**: Há»— trá»£ `/photo`, `/record`, `/warning` Ä‘á»ƒ Ä‘iá»u khiá»ƒn thá»§ cÃ´ng.
- **Äá»™ trá»… Tháº¥p**: Xá»­ lÃ½ cáº£nh bÃ¡o trong 0.5 giÃ¢y, vá»›i khoáº£ng cÃ¡ch giá»¯a cÃ¡c cáº£nh bÃ¡o lÃ  5 giÃ¢y.

### ğŸ“Š Hiá»‡u suáº¥t Cao

- **Xá»­ lÃ½ Báº¥t Ä‘á»“ng bá»™**: Sá»­ dá»¥ng luá»“ng riÃªng Ä‘á»ƒ xá»­ lÃ½ tÃ¡c vá»¥, Ä‘áº£m báº£o video mÆ°á»£t mÃ .
- **LÆ°u trá»¯ Tá»‘i Æ°u**: LÆ°u áº£nh vÃ  video vÃ o cÃ¡c thÆ° má»¥c `alerts`, `manual_captures`, `videos`.
- **TÃ¹y chá»‰nh Linh hoáº¡t**: Äiá»u chá»‰nh ngÆ°á»¡ng chuyá»ƒn Ä‘á»™ng vÃ  Ä‘á»™ tÆ°Æ¡ng Ä‘á»“ng theo nhu cáº§u.

## ğŸ”§ CÃ´ng nghá»‡ Sá»­ dá»¥ng

### CÃ´ng nghá»‡ ChÃ­nh

- **Xá»­ lÃ½ video vÃ  phÃ¡t hiá»‡n khuÃ´n máº·t**
- **PhÃ¡t hiá»‡n ngÆ°á»i**
- **Nháº­n diá»‡n danh tÃ­nh**
- **Káº¿t ná»‘i Telegram**

### ThÆ° viá»‡n Há»— trá»£

- `numpy`, `torch`, `requests`, `pickle` - TÃ­nh toÃ¡n vÃ  quáº£n lÃ½ dá»¯ liá»‡u
- `threading`, `queue` - Äa luá»“ng vÃ  hÃ ng Ä‘á»£i tÃ¡c vá»¥

## ğŸ“¥ HÆ°á»›ng dáº«n CÃ i Ä‘áº·t

### ğŸ› ï¸ YÃªu cáº§u

- ğŸ **Python 3.8+**: NgÃ´n ngá»¯ chÃ­nh
- ğŸ“· **Camera**: Camera USB hoáº·c IP tÆ°Æ¡ng thÃ­ch OpenCV
- ğŸ’¾ **RAM 4GB+**: Tá»‘i thiá»ƒu (khuyáº¿n nghá»‹ 8GB)
- ğŸ’» **CPU 2+ lÃµi**: Há»— trá»£ xá»­ lÃ½ song song
- ğŸ–´ **Dung lÆ°á»£ng 5GB+**: LÆ°u trá»¯ áº£nh, video vÃ  embeddings
- ğŸŒ **Káº¿t ná»‘i Internet**: Cáº§n thiáº¿t cho thÃ´ng bÃ¡o Telegram

### âš™ï¸ CÃ¡c bÆ°á»›c CÃ i Ä‘áº·t

#### ğŸ“¦ Táº£i Repository

```bash
git clone https://github.com/AIoTLab-DNU/MotionIdentitySurveillance.git
cd MotionIdentitySurveillance
```

#### ğŸŒŸ Táº¡o MÃ´i trÆ°á»ng áº¢o

```bash
python -m venv venv
source venv/bin/activate  # TrÃªn Windows: venv\Scripts\activate
```

#### ğŸ“š CÃ i Ä‘áº·t ThÆ° viá»‡n

```bash
pip install -r requirements.txt
```

**LÆ°u Ã½**: Táº¡o file `requirements.txt` vá»›i ná»™i dung:

```text
opencv-python
torch
numpy
telebot
requests
ultralytics
deepface
```

#### âš¡ Cáº¥u hÃ¬nh Há»‡ thá»‘ng

1. Táº¡o bot Telegram qua [BotFather](https://t.me/BotFather) Ä‘á»ƒ láº¥y `TELEGRAM_BOT_TOKEN`.
2. Láº¥y `TELEGRAM_CHAT_ID` báº±ng cÃ¡ch gá»­i tin nháº¯n cho bot vÃ  kiá»ƒm tra ID.
3. Cáº­p nháº­t cáº¥u hÃ¬nh trong file `surveillance.py`:

```python
TELEGRAM_BOT_TOKEN = "your_bot_token"
TELEGRAM_CHAT_ID = "your_chat_id"
```

#### ğŸ“‚ Chuáº©n bá»‹ Embeddings

- Äáº·t file `embeddings.pkl` vÃ o thÆ° má»¥c gá»‘c. File nÃ y chá»©a dictionary `{image_path: {"embedding": embedding_vector}}`.
- Náº¿u chÆ°a cÃ³, xem pháº§n **ThÃªm KhuÃ´n máº·t** Ä‘á»ƒ táº¡o.

## ğŸš€ Báº¯t Ä‘áº§u Sá»­ dá»¥ng

### âš¡ Cháº¡y Há»‡ thá»‘ng

```bash
python surveillance.py
```

Há»‡ thá»‘ng sáº½ khá»Ÿi Ä‘á»™ng camera, phÃ¡t hiá»‡n chuyá»ƒn Ä‘á»™ng, nháº­n diá»‡n danh tÃ­nh vÃ  gá»­i cáº£nh bÃ¡o qua Telegram.
Nháº¥n `q` trong cá»­a sá»• OpenCV Ä‘á»ƒ thoÃ¡t.

### ğŸ“¸ Chá»¥p áº¢nh

Gá»­i lá»‡nh `/photo` qua Telegram Ä‘á»ƒ chá»¥p vÃ  nháº­n áº£nh tá»« camera.

### ğŸ¥ Quay Video

Gá»­i lá»‡nh `/record` Ä‘á»ƒ quay video 10 giÃ¢y vÃ  nháº­n qua Telegram.

### ğŸš¨ Gá»­i Cáº£nh bÃ¡o Thá»§ cÃ´ng

Gá»­i lá»‡nh `/warning` Ä‘á»ƒ gá»­i cáº£nh bÃ¡o qua Telegram.

## ğŸ“¥ ThÃªm KhuÃ´n máº·t vÃ o CÆ¡ sá»Ÿ Dá»¯ liá»‡u

### Äá»ƒ thÃªm danh tÃ­nh má»›i:

```python
from deepface import DeepFace
import pickle
import os

# Script máº«u Ä‘á»ƒ thÃªm khuÃ´n máº·t
face_img_path = "Ä‘Æ°á»ng/dáº«n/Ä‘áº¿n/face.jpg"
identity = "Nguyen Van A"

embedding = DeepFace.represent(
    img_path=face_img_path,
    model_name="Facenet512",
    detector_backend="opencv"
)[0]["embedding"]

# Táº£i hoáº·c táº¡o má»›i embeddings
if os.path.exists("embeddings.pkl"):
    with open("embeddings.pkl", "rb") as f:
        embeddings = pickle.load(f)
else:
    embeddings = {}

# ThÃªm embedding vá»›i nhÃ£n danh tÃ­nh
embeddings[f"known_faces/{identity}/{os.path.basename(face_img_path)}"] = {"embedding": embedding}

# LÆ°u láº¡i file embeddings
with open("embeddings.pkl", "wb") as f:
    pickle.dump(embeddings, f)
print(f"ÄÃ£ thÃªm {identity} vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u embeddings.")
```
## ğŸ“° Poster
<p align="center">
  <img src="https://github.com/nguyenducduy2612/Nhan_dien_KM_CD/blob/main/images/Poster_Nhom4_Aiot.png?raw=true" 
       alt="System Architecture" width="800"/>
</p>

## ğŸ“š TÃ i liá»‡u Há»— trá»£

Xem chi tiáº¿t táº¡i:

- ğŸ“– **HÆ°á»›ng dáº«n CÃ i Ä‘áº·t**
- ğŸ‘¥ **HÆ°á»›ng dáº«n Sá»­ dá»¥ng**
- ğŸ”§ **TÃ i liá»‡u API**
- ğŸ¤ **HÆ°á»›ng dáº«n ÄÃ³ng gÃ³p**

## ğŸ“ Giáº¥y phÃ©p

Â© 2025 AIoTLab, Khoa CÃ´ng nghá»‡ ThÃ´ng tin, Äáº¡i há»c Äáº¡i Nam. Má»i quyá»n Ä‘Æ°á»£c báº£o lÆ°u.

---

**PhÃ¡t triá»ƒn vá»›i ğŸ’» bá»Ÿi AIoTLab, Äáº¡i há»c Äáº¡i Nam**

ğŸŒ [Website](https://aiotlab-dnu.com) â€¢ ğŸ”— [GitHub](https://github.com/AIoTLab-DNU) â€¢ ğŸ“© [LiÃªn há»‡](mailto\:contact@aiotlab-dnu.com)


